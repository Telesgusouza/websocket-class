package com.example.demo.providers;

import org.junit.jupiter.api.Assertions;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;

@SpringBootTest
public class JsonWebTokenProviderTest {

	@Autowired
	private TokenProvider tokenProvider;

	private String token = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImhrR3ZqeG5HS29sclAxS01oNG9hdyJ9.eyJnaXZlbl9uYW1lIjoiR3VzdGF2byIsImZhbWlseV9uYW1lIjoiVGVsZXMiLCJuaWNrbmFtZSI6Imd1c3Rhdm8udGVsZXM3MTEiLCJuYW1lIjoiR3VzdGF2byBUZWxlcyIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NLVnFrR1hqdldiMjBYOTVHUDVack9yQXVySFlWSGtjR01fVVFxTnZGQ0xJeE1xUXc9czk2LWMiLCJ1cGRhdGVkX2F0IjoiMjAyNC0wNy0wN1QxMjo1NDo1Ny4zNjdaIiwiZW1haWwiOiJndXN0YXZvLnRlbGVzNzExQGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJpc3MiOiJodHRwczovL2Rldi1rb295ZW1kY3dpNmVsYjJpLnVzLmF1dGgwLmNvbS8iLCJhdWQiOiJaMVpUUHd5Z2htelpvWVF5UTFEc2hZVENrZ0diTDVZdiIsImlhdCI6MTcyMDM1Njg5OCwiZXhwIjoxNzIwMzkyODk4LCJzdWIiOiJnb29nbGUtb2F1dGgyfDExNTk4MDc3NDg0Mzc0Nzc2MDE1OCIsInNpZCI6InpmYmxCSmRqbm9xc05KWTJDb0lZT2FzdzE0dURCMWVFIiwibm9uY2UiOiJaRlF6ZEV4NFJGbEhUVFkzUlRoQlVtZzVkbkZXYUZwT1pHUkdPWGQwYlhsVGJGaHNYMEZ3Y0ZCSFZnPT0ifQ.soiPLuzKBn805iYX-OKPMyT7WxkwcfW9W1hgZf5w91J014jwNcM5EAxyna4R3JcR7GewOFyOa5VTQYhSsoheicp3LpxM1To87SRn7XvJOKnWx0c0lZijwxioNm-e8SwbXka9rz-038rBWas4qy_ciNd5pmHxZ_SsRHPzL4oesAw01A2H62f8rZBDEq31iW5OZTJbElxV_vGW5m5geEcpzOWD0xPhPPpdYcJR9u8VIO93nC4BoptiYFgjgOT78YRPV16Ql7GT7FkkM68X0qDkFR79pzf0S1vQa9M7FIU__iRm-m5l8KueLLxbL342wDDPzbJgjBfJRjzk-9KUP2eQuQ";

	void test() {
		final RuntimeException e = Assertions.assertThrows(RuntimeException.class, () -> {
			tokenProvider.decode("eyJ...");
		});
		Assertions.assertEquals("token is expired", e.getMessage());
	}

}
